# Основные сущности

## Пользователи
- Telegram ID (int, уникальный идентификатор пользователя, внешний по отношению к системе, primary key)
- Имя/Ник (str)
- Куплен премиум (bool, по умолчанию false)

## Автомобиль
- ID (uuid, primary key)
- Telegram ID пользователя (foreign key → Пользователи.Telegram ID, on delete cascade)
- Марка (str)
- Модель (str)
- Год (int, >1930, < current_year)
- Пробег при первом добавлении в бота, км (int)
- Текущий пробег — не хранится в БД; вычисляется на лету по записям из таблицы Пробег (derived field)

## Пробег
- ID (uuid, primary key)
- ID автомобиля (foreign key → Автомобиль.ID, on delete cascade)
- Дата (TIMESTAMPTZ, хранится в UTC, сервер)
- Количество в км (int)
- Валидация: общий одометр не должен уменьшаться относительно предыдущей записи

## Расходник/Элемент обслуживания
- ID (uuid, primary key)
- ID автомобиля (foreign key → Автомобиль.ID, on delete cascade)
- Название (str)
- Дата последней замены (TIMESTAMPTZ)
- Пробег на последней замене (int, км)

## Напоминание
- ID (uuid, primary key)
- ID автомобиля (foreign key → Автомобиль.ID, on delete cascade)
- ID расходника (foreign key → Расходник.ID)
- Статус активно/неактивно (bool)
- Интервал пробега в км (int, nullable)
- Интервал времени в днях (int, nullable)
- Порог пробега для предупреждения, количество км (int)
- Порог времени для предупреждения, количество дней (int)
- Комментарий (str, optional)
- Ограничение: хотя бы один из интервалов (км или дни) должен быть задан; напоминание сработает по принципу "что наступит раньше: по пробегу или по времени"

# Правила срабатывания напоминаний
По пробегу: напоминать, когда текущий пробег ≥ (пробег на последней замене + интервал пробега − порог пробега для предупреждения); текущий пробег берётся как одометр из таблицы Пробег для автомобиля
По времени: напоминать, когда now() ≥ (дата последней замены + интервал времени в днях − порог времени в днях), все сравнения в TIMESTAMPTZ/UTC для корректности таймзон
Итоговое правило: напоминание сработает по принципу "что наступит раньше" при выполнении любого из условий


# Сценарий использования
1. Пользователь заходит в бота впервые, читает описание
2. Добавляет автомобиль
3. Добавляет расходник к автомобилю
4. Добавляет напоминание к расходнику, например, «Масло каждые 7000 км», опционально задаёт интервал по времени (например, 180 дней) и комментарий
5. Настраивает ввод пробега в двух вариантах: вводит общий текущий одометр или прирост; система валидирует неубывающий одометр и считает разницу автоматически
6. Периодически заполняет пройденный пробег
7. Получает уведомление о замене, когда наступает условие по км или по времени с учётом порогов, в соответствии с правилом «что наступит раньше»

# Команды в боте

## Основные
/start - приветствие, краткое описание возможностей
/help - краткая справка по командам и боту в целом

## Автомобиль
/add_car - добавить автомобиль
/cars - список автомобилей
/del_car - удалить автомобиль

## Пробег
/add_mileage - добавить пробег
/mileage - показать текущий пробег и последние 5 записей

## Расходник
/add_item - добавить расходник
/items - список расходников
/last_service - отметить выпоненную замену для расходника (фиксирует дату и пробег)
/del_item - удалить расходник

## Напоминание
/set_reminder - создать/изменить напоминание
/reminders - список напоминаний, статусы активно/неактивно
/due - показать, что скоро наступил или уже просрочено

## Настройки
/settings - список настроек: часовой пояс, язык, частота напоминаний о вводе пробега
/premium - статус премиума и преимущества
